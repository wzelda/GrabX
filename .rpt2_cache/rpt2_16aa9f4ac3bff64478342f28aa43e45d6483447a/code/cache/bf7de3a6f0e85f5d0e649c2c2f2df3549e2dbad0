{
  "code": "import * as Config from \"./Config/Config\";\r\nimport * as Manager from \"./Manager/Manager\";\r\nimport * as Data from './Data/Data';\r\nimport * as Common from \"./Common/Common\";\r\nimport * as Logic from \"./Logic/Logic\";\r\nexport class GameScene extends Common.EventDispather {\r\n    static get inst() {\r\n        return this._inst;\r\n    }\r\n    onAwake() {\r\n        GameScene._inst = this;\r\n        this.owner.addComponent(Logic.GrabLogic);\r\n    }\r\n    init() {\r\n        Manager.VersionManager.Version = Config.VersionConfig.Develop;\r\n        if (Laya.Browser.onMiniGame) {\r\n            Laya.URL.basePath = \"https://706.lightpaw.cn/h5c/resCache/DietyRoad/\";\r\n            Laya.MiniAdpter.nativefiles = [\r\n                \"libs\",\r\n                \"res/config\",\r\n            ];\r\n        }\r\n        this.initFairygui();\r\n        this.loadLoginUiRes();\r\n    }\r\n    initFairygui() {\r\n        fgui.UIConfig.packageFileExtension = \"txt\";\r\n        Laya.stage.addChild(fgui.GRoot.inst.displayObject);\r\n    }\r\n    loadLoginUiRes() {\r\n        Common.Resource.load(Config.loginResUrls, this, this.onLogingResLoaded);\r\n    }\r\n    onLogingResLoaded() {\r\n        this.preLogin();\r\n    }\r\n    loadRes() {\r\n        Common.Resource.load(Config.urls, this, this.onResLoaded, this.onLoading);\r\n    }\r\n    onLoading(progress) {\r\n        console.log(\"加载进度: \" + progress);\r\n    }\r\n    onResLoaded(info) {\r\n        if (!info) {\r\n            return console.error('Load fairygui package fail');\r\n        }\r\n        Config.UIConfig.UIPkgs.forEach(pkg => {\r\n            Common.Resource.addUiPackage(pkg);\r\n        });\r\n        Config.UIConfig.LoginPackageLoaded = true;\r\n        this.dispatchEvent(Common.SceneLoginEid.PackageLoaded);\r\n        this.loadConfig();\r\n    }\r\n    preLogin() {\r\n        this.openLoginUI();\r\n        this.checkVersion();\r\n    }\r\n    checkVersion() {\r\n        switch (Manager.VersionManager.Version) {\r\n            case Config.VersionConfig.Develop:\r\n                this.openChooseServiceUi();\r\n                break;\r\n            case Config.VersionConfig.Release:\r\n                Config.NetConfig.RequestUrl = Config.NetConfig.HttpRequestUrl;\r\n                break;\r\n        }\r\n    }\r\n    onVersionChecked() {\r\n        this.loadRes();\r\n    }\r\n    openLoginUI() {\r\n        Manager.LoadingProgressManager.Inst.showUiProgress(5);\r\n    }\r\n    openChooseServiceUi() {\r\n        this.dispatchEvent(Config.ViewKit.ChooseService.Key);\r\n    }\r\n    loadConfig() {\r\n        Data.ConfigData.SendReq([]);\r\n    }\r\n    onConfigLoaded() {\r\n        this.loginGame();\r\n    }\r\n    loginGame() {\r\n        if (Config.NetConfig.RequestUrl == Config.NetConfig.LocalRequestUrl) {\r\n            this.testLogin();\r\n        }\r\n        else if (Config.NetConfig.RequestUrl == Config.NetConfig.LocalWechatRequestUrl && Common.isOnWeixin()) {\r\n        }\r\n        else if (Common.isOnWeixin()) {\r\n        }\r\n        else {\r\n            this.testLogin();\r\n        }\r\n    }\r\n    testLogin() {\r\n        let acc;\r\n        let tempName = Config.NetConfig.TempName;\r\n        if (tempName) {\r\n            acc = tempName;\r\n        }\r\n        else {\r\n            acc = \"temp\" + Math.random();\r\n        }\r\n        let reqdata = new Config.LoginReqData(acc);\r\n        Data.LoginData.SendReq(reqdata);\r\n    }\r\n    onLogined() {\r\n        this.openMainUi();\r\n    }\r\n    openMainUi() {\r\n        this.dispatchEvent(Common.SceneEnterEid.MainMenu);\r\n        this.dispatchEvent(Config.ViewKit.MainMenu.Key);\r\n    }\r\n}\r\n",
  "references": [
    "E:/Practise/demo3DLaya/GrabX/src/Config/DataConfig.ts",
    "E:/Practise/demo3DLaya/GrabX/src/Config/LocalConfig.ts",
    "E:/Practise/demo3DLaya/GrabX/src/Config/Config.ts",
    "E:/Practise/demo3DLaya/GrabX/src/Manager/Manager.ts",
    "E:/Practise/demo3DLaya/GrabX/src/UI/UI.ts",
    "E:/Practise/demo3DLaya/GrabX/src/Data/Data.ts",
    "E:/Practise/demo3DLaya/GrabX/src/Common/Common.ts",
    "E:/Practise/demo3DLaya/GrabX/src/Logic/Logic.ts"
  ]
}
